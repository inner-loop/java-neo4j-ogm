<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Java-neo4j-ogm by inner-loop</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Java-neo4j-ogm</h1>
      <h2 class="project-tagline">A minimalist Java Object Graph Mapper (OGM) for Neo4J.</h2>
      <a href="https://github.com/inner-loop/java-neo4j-ogm" class="btn">View on GitHub</a>
      <a href="https://github.com/inner-loop/java-neo4j-ogm/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/inner-loop/java-neo4j-ogm/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="java-neo4j-ogm" class="anchor" href="#java-neo4j-ogm" aria-hidden="true"><span class="octicon octicon-link"></span></a>java-neo4j-ogm</h1>

<p>A minimalist Java Object Graph Mapper (OGM) for Neo4J.</p>

<p><a href="https://travis-ci.org/inner-loop/java-neo4j-ogm"><img src="https://travis-ci.org/inner-loop/java-neo4j-ogm.svg?branch=master" alt="Build Status"></a></p>

<h1>
<a id="features" class="anchor" href="#features" aria-hidden="true"><span class="octicon octicon-link"></span></a>Features</h1>

<ol>
<li>Mapping of POJO's to Neo4J Nodes &amp; Relationships with minimal use of annotations.</li>
<li>First class support for Cypher querying with automatic domain mapping of results.</li>
<li>Persistence by reachability. No need to call save() for objects already in the database!</li>
<li>Built with Rich Domains in mind!  Support for automatic retrieval of <a href="http://en.wikipedia.org/wiki/Domain-driven_design">DDD</a> aggregates via the <code>@Aggregate</code> annotation.</li>
<li>Annotation overriding for when defaults aren't good enough.</li>
<li>Fast class scanning on startup with <a href="https://github.com/ronmamo/reflections">Reflections</a>.</li>
<li>Efficient statement batching thanks to <a href="https://github.com/inner-loop/java-neo4j-client">Java Neo4J Client</a> Connections.</li>
<li>Out of the box support for maps and relationship properties.</li>
</ol>

<h1>
<a id="quick-start" class="anchor" href="#quick-start" aria-hidden="true"><span class="octicon octicon-link"></span></a>Quick Start</h1>

<p>The Java Neo4J OGM is written for and requires:</p>

<ul>
<li>Java 8+</li>
<li>Neo4J 2.2+ Standalone Database.</li>
</ul>

<h2>
<a id="install-from-maven" class="anchor" href="#install-from-maven" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install from Maven</h2>

<p>Add the following to your <code>&lt;dependencies&gt; .. &lt;/dependencies&gt;</code> section.</p>

<pre lang="maven"><code>&lt;dependency&gt;
    &lt;groupId&gt;io.innerloop&lt;/groupId&gt;
    &lt;artifactId&gt;java-neo4j-ogm&lt;/artifactId&gt;
    &lt;version&gt;0.1.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<h2>
<a id="install-from-gradle" class="anchor" href="#install-from-gradle" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install from Gradle</h2>

<p>Add the following to your <code>dependencies { .. }</code> section.</p>

<div class="highlight highlight-gradle"><pre>compile <span class="pl-c1">group</span>: <span class="pl-s"><span class="pl-pds">'</span>io.innerloop<span class="pl-pds">'</span></span>, <span class="pl-c1">name</span>: <span class="pl-s"><span class="pl-pds">'</span>java-neo4j-ogm<span class="pl-pds">'</span></span>, <span class="pl-c1">version</span>: <span class="pl-s"><span class="pl-pds">'</span>0.1.0<span class="pl-pds">'</span></span></pre></div>

<p>... or more simply:</p>

<div class="highlight highlight-gradle"><pre><span class="pl-c1">compile</span>: <span class="pl-s"><span class="pl-pds">'</span>io.innerloop:java-neo4j-ogm:0.1.0<span class="pl-pds">'</span></span></pre></div>

<h1>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h1>

<h2>
<a id="initialising-the-sessionfactory" class="anchor" href="#initialising-the-sessionfactory" aria-hidden="true"><span class="octicon octicon-link"></span></a>Initialising the SessionFactory.</h2>

<p>To intialise the SessionFactory you must supply it with an instance 
of a <a href="https://github.com/inner-loop/java-neo4j-client/blob/master/src/main/java/io/innerloop/neo4j/client/Neo4jClient.java">Neo4JClient</a>
 as well as the location of the base of the domain POJO's you would like to be mapped (or an array of locations).</p>

<p>Classes must:</p>

<ol>
<li>Have a field of type <code>Long</code> called <code>id</code>. It may have any visibility modifier. Note that this ID should not
be relied upon to be unique. It is an implementation detail exposed by Neo4J.</li>
<li>Have a field marked with the annotation <code>@Id</code>. This field must hold a unique identifier for that Class.</li>
</ol>

<p>To ignore classes in scanning mark them with the <code>@Transient</code> annotation.</p>

<p>It's worth noting that this OGM does not support lazy loading by default. This will probably be partially supported in the
next release.</p>

<h1>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h1>

<h1>
<a id="basic-example" class="anchor" href="#basic-example" aria-hidden="true"><span class="octicon octicon-link"></span></a>Basic Example</h1>

<p>Let's model a Twitter domain. We'll keep it simple and have Users and Tweets.</p>

<p><strong>User.java</strong></p>

<div class="highlight highlight-java"><pre><span class="pl-c">// Notice we have no need for annotations!</span>
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">User</span>
{
    <span class="pl-c">// This is required to be in every class.</span>
    <span class="pl-k">private</span> <span class="pl-smi">Long</span> id;

    <span class="pl-c">// Each class must have exactly one @Id.</span>
    <span class="pl-c">// The next release will have a UUIDGenerator annotation that</span>
    <span class="pl-c">// will replace the need to have a converter and a generator in the constructor.</span>
    <span class="pl-k">@Id</span>
    <span class="pl-k">@Convert</span>(<span class="pl-smi">UUIDConverter</span><span class="pl-k">.</span>class)
    <span class="pl-k">private</span> <span class="pl-c1">UUID</span> uuid;

    <span class="pl-c">// We can also specify as many indexes and constraints we we want!</span>
    <span class="pl-k">@Index</span>(<span class="pl-c1">unique</span><span class="pl-k">=</span><span class="pl-c1">true</span>)
    <span class="pl-k">private</span> <span class="pl-smi">String</span> username;

    <span class="pl-k">private</span> <span class="pl-smi">String</span> passwordHash;

    <span class="pl-k">private</span> <span class="pl-smi">String</span> name;

    <span class="pl-c">// Again no annotation unless we want to model the relationship differently.</span>
    <span class="pl-c">// @Fetch will force this object to automatically load Tweets eagerly.</span>
    <span class="pl-k">private</span> <span class="pl-k">List&lt;<span class="pl-smi">Tweet</span>&gt;</span> posts;

    <span class="pl-c">// You must supply a public empty constructor.</span>
    <span class="pl-k">public</span> <span class="pl-en">User</span>()
    {
    }

    <span class="pl-k">public</span> <span class="pl-en">User</span>(<span class="pl-smi">String</span> <span class="pl-v">username</span>, <span class="pl-smi">String</span> <span class="pl-v">password</span>, <span class="pl-smi">String</span> <span class="pl-v">name</span>)
    {
        <span class="pl-v">this</span><span class="pl-k">.</span>uuid <span class="pl-k">=</span> <span class="pl-smi">UuidGenerator</span><span class="pl-k">.</span>generate(); <span class="pl-c">// this is just a generator that comes bundled with the OGM.</span>
        <span class="pl-v">this</span><span class="pl-k">.</span>name <span class="pl-k">=</span> name;
        <span class="pl-v">this</span><span class="pl-k">.</span>passwordHash <span class="pl-k">=</span> <span class="pl-smi">BCrypt</span><span class="pl-k">.</span>hashpw(password, <span class="pl-smi">BCrypt</span><span class="pl-k">.</span>gensalt());
        <span class="pl-v">this</span><span class="pl-k">.</span>posts <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">ArrayList&lt;&gt;</span>();
    }

    <span class="pl-k">public</span> <span class="pl-smi">String</span> <span class="pl-en">getUsername</span>() 
    {
        <span class="pl-k">return</span> <span class="pl-v">this</span><span class="pl-k">.</span>username;
    }

    <span class="pl-k">public</span> <span class="pl-k">Iterable&lt;<span class="pl-smi">Tweet</span>&gt;</span> <span class="pl-en">getPosts</span>()
    {
        <span class="pl-k">return</span> <span class="pl-v">this</span><span class="pl-k">.</span>posts;
    }

    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">post</span>(<span class="pl-smi">Tweet</span> <span class="pl-v">tweet</span>)
    {
        <span class="pl-v">this</span><span class="pl-k">.</span>posts<span class="pl-k">.</span>add(tweet);
    }
}</pre></div>

<p><strong>Tweet.java</strong></p>

<div class="highlight highlight-java"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Tweet</span>
{
    <span class="pl-c">// This is required to be in every class.</span>
    <span class="pl-k">private</span> <span class="pl-smi">Long</span> id;

    <span class="pl-k">@Id</span>
    <span class="pl-k">@Convert</span>(<span class="pl-smi">UUIDConverter</span><span class="pl-k">.</span>class)
    <span class="pl-k">private</span> <span class="pl-c1">UUID</span> uuid;

    <span class="pl-k">private</span> <span class="pl-smi">String</span> text;

    <span class="pl-c">// You must supply a public empty constructor.</span>
    <span class="pl-k">public</span> <span class="pl-en">Tweet</span>()
    {
    }

    <span class="pl-k">public</span> <span class="pl-en">Tweet</span>(<span class="pl-smi">String</span> <span class="pl-v">username</span>, <span class="pl-smi">String</span> <span class="pl-v">password</span>, <span class="pl-smi">String</span> <span class="pl-v">name</span>)
    {
        <span class="pl-v">this</span><span class="pl-k">.</span>uuid <span class="pl-k">=</span> <span class="pl-smi">UuidGenerator</span><span class="pl-k">.</span>generate(); <span class="pl-c">// this is just a generator that comes bundled with the OGM.</span>
        <span class="pl-v">this</span><span class="pl-k">.</span>name <span class="pl-k">=</span> name;
        <span class="pl-v">this</span><span class="pl-k">.</span>passwordHash <span class="pl-k">=</span> <span class="pl-smi">BCrypt</span><span class="pl-k">.</span>hashpw(password, <span class="pl-smi">BCrypt</span><span class="pl-k">.</span>gensalt())
    }

    <span class="pl-k">public</span> <span class="pl-smi">String</span> <span class="pl-en">getUsername</span>() 
    {
        <span class="pl-k">return</span> <span class="pl-v">this</span><span class="pl-k">.</span>username;
    }
}
</pre></div>

<div class="highlight highlight-java"><pre><span class="pl-c">// Create a new Neo4j Client</span>
<span class="pl-smi">Neo4jClient</span> client <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">Neo4jClient</span>(<span class="pl-s"><span class="pl-pds">"</span>http://localhost:7474/db/data<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>neo4j<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>neo4j<span class="pl-pds">"</span></span>);

<span class="pl-c">// Obtain a new Session Factory. You should only do this once for a JVM instance.</span>
<span class="pl-smi">SessionFactory</span> sessionFactory <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">SessionFactory</span>(client, <span class="pl-s"><span class="pl-pds">"</span>com.example.domain<span class="pl-pds">"</span></span>);

<span class="pl-c">// Obtain a new Session and create a new Transaction.</span>
<span class="pl-smi">Session</span> session <span class="pl-k">=</span> sessionFactory<span class="pl-k">.</span>getCurrentSession();
<span class="pl-smi">Transaction</span> transaction <span class="pl-k">=</span> session<span class="pl-k">.</span>getTransaction();
<span class="pl-k">try</span>
{
    transaction<span class="pl-k">.</span>begin(); <span class="pl-c">// Start the Transaction.</span>

    <span class="pl-smi">User</span> mark <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">User</span>(<span class="pl-s"><span class="pl-pds">"</span>@markanrish<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>password<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Mark Angrish<span class="pl-pds">"</span></span>);
    mark<span class="pl-k">.</span>post(<span class="pl-k">new</span> <span class="pl-smi">Tweet</span>(<span class="pl-s"><span class="pl-pds">"</span>Here is an awesome Tweet!<span class="pl-pds">"</span></span>);

    session<span class="pl-k">.</span>save(mark);

    transaction<span class="pl-k">.</span>flush();

    <span class="pl-smi">User</span> twitterUser <span class="pl-k">=</span> session<span class="pl-k">.</span>load(<span class="pl-smi">User</span><span class="pl-k">.</span>class, <span class="pl-s"><span class="pl-pds">"</span>username<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>@markangrish<span class="pl-pds">"</span></span>);
    transaction<span class="pl-k">.</span>commit();

    <span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>Is the twitterUser Mark? [<span class="pl-pds">"</span></span> <span class="pl-k">+</span> twitterUser<span class="pl-k">.</span>getUsername()<span class="pl-k">.</span>equals(mark<span class="pl-k">.</span>getUsername()) <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>]<span class="pl-pds">"</span></span>);
    <span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>Does the twitterUser have 1 post? [<span class="pl-pds">"</span></span> <span class="pl-k">+</span> twitterUser<span class="pl-k">.</span>getPosts()<span class="pl-k">.</span>size() <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>]<span class="pl-pds">"</span></span>);
}
<span class="pl-k">finally</span>
{
    session<span class="pl-k">.</span>close();
}
</pre></div>

<h1>
<a id="spring-support" class="anchor" href="#spring-support" aria-hidden="true"><span class="octicon octicon-link"></span></a>Spring Support</h1>

<p>This is a simple Java OGM for Neo4J. This OGM is designed to be used
agnostic of any other framework, library or middleware.</p>

<p>If you want out of the box Spring support right now check out the 
<a href="http://docs.spring.io/spring-data/neo4j/docs/4.0.0.M1/">Spring Data Neo4J project</a> (of which I'm also a contributor!)</p>

<p>I plan on adding spring support in a later release.</p>

<h2>
<a id="comparison-with-spring-data-neo4j" class="anchor" href="#comparison-with-spring-data-neo4j" aria-hidden="true"><span class="octicon octicon-link"></span></a>Comparison with Spring Data Neo4J.</h2>

<ul>
<li>This OGM does not support the concept of "Relationship Entities" natively. Relationships in a Neo4J Database provide
metadata about the relationship between two nodes. Instead, relationships with properties can be modelled with defining ordering 
or grouping semantics (e.g. order a list of objects by a relationship property called 'weight' etc.).</li>
<li>If you only do things "the Spring way" then this project is probably not for you!</li>
</ul>

<h1>
<a id="feature-requests--roadmap" class="anchor" href="#feature-requests--roadmap" aria-hidden="true"><span class="octicon octicon-link"></span></a>Feature Requests / Roadmap</h1>

<p>Do you have a feature request? <a href="https://github.com/inner-loop/java-neo4j-ogm/issues/new">Create a new Issue</a>.</p>

<h2>
<a id="backlog" class="anchor" href="#backlog" aria-hidden="true"><span class="octicon octicon-link"></span></a>Backlog</h2>

<ul>
<li>Automatic registration of default converters</li>
<li>Fix Session/Transaction behaviour.</li>
<li>Add <a href="https://github.com/Target" class="user-mention">@Target</a> annotation which will allow DDD style loading against the target's <a href="https://github.com/Id" class="user-mention">@Id</a> in the referencing class.</li>
<li>Add performance tests against SDN 4.x</li>
<li>Introduce statement caching and 2nd Level Session Caching.</li>
<li>Add support to weight Lists by a relationship property.</li>
<li>Switch reflective code to Javassist. Remove required <code>Long id</code> field from classes.</li>
<li>Add Spring <a href="https://github.com/Transactional" class="user-mention">@Transactional</a> Support</li>
<li>Add Guice/Transaction support.</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/inner-loop/java-neo4j-ogm">Java-neo4j-ogm</a> is maintained by <a href="https://github.com/inner-loop">inner-loop</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

